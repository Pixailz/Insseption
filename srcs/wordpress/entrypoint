#!/bin/ash

if [ ! -d /var/www/html/wordpress ]; then

	printf "WordPress \x1b[38:2::255:0:0mnot found\x1b[00m, initialize it\n"

	cd /var/www/html/

	wget https://wordpress.org/wordpress-6.2.2.tar.gz
	tar xf wordpress-6.2.2.tar.gz && rm -rf wordpress-6.2.2.tar.gz
	cd wordpress

	wp config create \
		--dbname=${DB_NAME} \
		--dbuser=${ADMIN_USER} \
		--dbpass=${ADMIN_PASS} \
		--dbhost=mariadb \

	wp core install \
		--url=https://brda-sil.42.fr/wordpress \
		--title="${WP_TITLE}" \
		--admin_user=${ADMIN_USER} \
		--admin_password=${ADMIN_PASS} \
		--admin_email="${ADMIN_USER}@nowhere.com" \
		--skip-email

	wp user create ${NORMAL_USER} ${NORMAL_USER}@nowhere.com \
		--user_pass=${NORMAL_PASS} \
		--role=contributor

	wp theme activate twentytwentytwo

	cd - >/dev/null
else
	printf "WordPress \x1b[38:2::0:255:0mfound\x1b[00m, Skiping initialization\n"
fi

printf "launching WordPress on port: \x1b[38:2::255:128:0m9000\x1b[00m\n"

php-fpm81 -F -R
